from Bio.Blast import NCBIWWW
from Bio.Blast import NCBIXML
from Bio import SeqIO
from Bio import Seq

handle = open("thrombin.fa")
#records = SeqIO.parse(handle,"fasta")
#first_seq = records.next().seq
#result = NCBIWWW.qblast("blastn", "nr", first_seq)
#print(result)
for record in SeqIO.parse(handle, "fasta") :
#	sequences.append(record.seq)
	result = NCBIWWW.qblast("blastp", "nr", record.seq)
#print(result)
handle.close()

#result = NCBIWWW.qblast("blastx", "nr", gi)

for n in NCBIXML.parse(result):
#blast_record = records.next()
	for alignment in n.alignments:
		for hsp in alignment.hsps:
#			if hsp.expect < 0.1:
				print ("****Alignment****")
				print ("sequence:", alignment.title)
				print ("length:", alignment.length)
				print ("E-value:", hsp.expect)
				print (hsp.query[:50] + "...")
				print (hsp.match[:50] + "...")
				print (hsp.sbjct[:50] + "...")
